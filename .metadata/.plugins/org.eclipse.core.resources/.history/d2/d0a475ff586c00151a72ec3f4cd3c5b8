import java.net.*;
import java.io.*;
import java.util.Random;
import java.lang.Thread;


public class ServerMain  {

	public static void main(String[] args) {
		Logger logger = new Logger();
		GyroQueue gyroQueue = GyroQueue.GetGyroQueue();
		logger.WriteLine("Start server");

		Random rnd = new Random();
		
		int x, y, z;
		int port1 = 12346;
		int port2 = 12347;
		try {
			Sender sender1 = new Sender(new ServerSocket(port1));
			Thread thr1 = new Thread(sender1);
			Sender sender2 = new Sender(new ServerSocket(port2));
			Thread thr2 = new Thread(sender2);
			thr1.start();
			thr2.start();
			logger.WriteLine("Start thread");
			//sender.run();	
			logger.WriteLine("before while");
			
			// данные с гироскопа обновл€еютс€ каждую милисекунду и отправл€ютс€ в Sender, который в другом потоке
			while(true) {
				x = rnd.nextInt();
				y = rnd.nextInt();
				z = rnd.nextInt();
				gyroQueue.PutElement(x, y, z);
				Thread.sleep(5000); // 5 sec of sleeping
			}
		} catch( Exception e ) {
			logger.WriteLine(e.getMessage());
		}
	}

}
